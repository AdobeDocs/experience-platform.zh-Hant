---
keywords: Experience Platform；主題；熱門主題；架構；架構；枚舉；主身份；主身份；XDM個人配置檔案；體驗事件；XDM體驗事件；XDM體驗事件；體驗事件；體驗事件；體驗事件；XDM體驗事件；體驗事件；XDM體驗事件；架構設計；最佳實踐
solution: Experience Platform
title: 資料建模的最佳做法
description: 本文檔介紹了經驗資料模型(XDM)架構，以及用於組合要在Adobe Experience Platform使用的架構的構成模組、原則和最佳做法。
exl-id: 2455a04e-d589-49b2-a3cb-abb5c0b4e42f
source-git-commit: 6327f5e6cb64a46c502613dd6074d84ed1fdd32b
workflow-type: tm+mt
source-wordcount: '2713'
ht-degree: 1%

---

# 資料模式的最佳做法

[!DNL Experience Data Model] (XDM)是核心框架，通過提供用於下游Adobe Experience Platform服務的通用結構和定義來標準化客戶體驗資料。 通過遵守XDM標準，所有客戶體驗資料都可以合併到一個通用表示形式中，這樣您就可以從客戶操作中獲得有價值的見解，通過細分市場定義客戶受眾，並為個性化目的表達客戶屬性。

由於XDM具有極強的通用性和可定製性，因此在設計模式時遵循資料建模的最佳做法非常重要。 本文檔介紹將客戶體驗資料映射到XDM時必須做出的關鍵決定和考慮事項。

## 快速入門

閱讀本指南前，請閱讀 [XDM系統概述](../home.md) 對XDM及其在Experience Platform中的作用進行高級別介紹。

此外，本指南專門介紹有關架構設計的關鍵注意事項。 因此，強烈建議您參考 [架構組合基礎](./composition.md) 有關本指南中提到的各個架構元素的詳細說明。

## 最佳做法摘要

建議的設計資料模型以供Experience Platform使用的方法可總結如下：

1. 瞭解資料的業務使用案例。
1. 確定應引入的主資料源 [!DNL Platform] 來解決這些使用案例。
1. 確定可能也有意見的任何輔助資料源。 例如，如果您組織中目前只有一個業務部門有興趣將其資料移植到 [!DNL Platform]類似的業務部門可能也有興趣在未來移植類似資料。 考慮到這些輔助源有助於整個組織的資料模型標準化。
1. 為已標識的資料源建立高級實體關係圖(ERD)。
1. 將高級ERD轉換為 [!DNL Platform]-centric ERD（包括配置檔案、體驗事件和查找實體）。

與確定執行業務使用案例所需的適用資料源相關的步驟因組織而異。 本文檔的其餘部分側重於在確定資料源後組織和構建ERD的後續步驟，但對圖表各組成部分的解釋可能會指導您決定將哪些資料源遷移到 [!DNL Platform]。

## 建立高級ERD

確定要引入的資料源後 [!DNL Platform]，建立高級ERD以幫助指導將資料映射到XDM架構的過程。

下面的示例為希望將資料納入到中的公司表示一個簡化的ERD [!DNL Platform]。 此圖突出了應按XDM類分類的基本實體，包括客戶帳戶、酒店、地址和幾個常見電子商務事件。

![](../images/best-practices/erd.png)

## 將實體排序到配置檔案、查找和事件類別

建立ERD以確定要引入的基本實體後 [!DNL Platform]，這些實體必須分為配置檔案、查找和事件類別：

| 類別 | 說明 |
| --- | --- |
| 配置檔案實體 | 配置檔案實體表示與個人（通常是客戶）相關的屬性。 屬於此類別的實體應由基於 **[!DNL XDM Individual Profile]類**。 |
| 查找實體 | 查找實體表示可與個人相關的概念，但不能直接用於標識個人。 屬於此類別的實體應由基於的架構來表示 **自定義類**，並連結到配置檔案和事件 [架構關係](../tutorials/relationship-ui.md)。 |
| 事件實體 | 事件實體表示與客戶可以採取的操作、系統事件或任何其它您可能希望跟蹤隨時間變化的概念相關的概念。 屬於此類別的實體應由基於 **[!DNL XDM ExperienceEvent]類**。 |

{style="table-layout:auto"}

### 實體排序的注意事項

以下各節提供了有關如何將實體分類到上述類別的進一步指導。

#### 可變和不可變資料

在實體類別之間排序的主要方法是要捕獲的資料是否可變。

屬於配置檔案或查找實體的屬性通常是可變的。 例如，客戶的首選項可能會隨時間而改變，並且訂閱計畫的參數可以根據市場趨勢進行更新。

相反，事件資料通常不可變。 由於事件附加到特定時間戳，因此事件提供的「系統快照」不會更改。 例如，事件可以在客戶簽出購物車時捕獲其首選項，即使客戶的首選項稍後會更改也不會更改。 事件資料在記錄後無法更改。

總而言之，配置檔案和查找實體包含可變屬性，並表示有關它們捕獲的主題的最新資訊，而事件是系統在特定時間的不可變記錄。

#### 客戶屬性

如果實體包含與單個客戶相關的任何屬性，則很可能是配置檔案實體。 客戶屬性示例包括：

* 個人詳細資訊，如姓名、出生日期、性別和帳戶ID。
* 地址和GPS資訊等位置資訊。
* 聯繫資訊，如電話號碼和電子郵件地址。

#### 跟蹤隨時間推移的資料

如果要分析實體中某些屬性隨時間的變化情況，則很可能是事件實體。 例如，將產品項添加到購物車中可以作為添加到購物車中的事件進行跟蹤 [!DNL Platform]:

| Customer ID | 類型 | 產品 ID | 數量 | 時間戳記 |
| --- | --- | --- | --- | --- |
| 1234567 | 新增 | 275098 | 2 | 10月1日，上午10點32分 |
| 1234567 | 移除 | 275098 | 1 | 10月1日，上午10點33分 |
| 1234567 | 新增 | 486502 | 1 | 10月1日，上午10點41分 |
| 1234567 | 新增 | 910482 | 5 | 10月3日，下午2:15 |

{style="table-layout:auto"}

#### 分段用例

在對實體進行分類時，必須考慮您可能希望構建的受眾群，以解決您的特定業務使用案例。

例如，一家公司希望瞭解其忠誠計畫中所有「黃金」或「白金」成員，這些成員去年已經購買了超過5筆產品。 根據這一段邏輯，可就如何表示相關實體得出以下結論：

* 「黃金」和「白金」表示適用於單個客戶的忠誠度狀態。 由於段邏輯僅與客戶的當前忠誠度狀態有關，因此此資料可以建模為配置檔案架構的一部分。 如果希望跟蹤會員狀態隨時間的變化，您還可以建立附加事件方案來更改會員狀態。
* 採購是在特定時間發生的事件，段邏輯涉及在指定時間窗口內的採購事件。 因此，應將此資料建模為事件模式。

#### 激活使用案例

除了考慮細分使用案例外，您還應查看這些片段的激活使用案例，以確定其他相關屬性。

例如，公司根據以下規則構建了受眾群 `country = US`。 然後，在將該段激活到特定的下游目標時，公司希望根據家庭狀態過濾所有導出的配置檔案。 因此， `state` 屬性也應在適用的配置檔案實體中捕獲。

#### 聚合值

根據資料的使用案例和粒度，您應確定在將某些值包括在配置檔案或事件實體中之前是否需要預先聚合。

例如，公司希望根據購物車數量構建一個段。 通過將每個時間戳採購事件作為其自己的實體，您可以選擇以最低粒度合併此資料。 但是，這有時會以指數方式增加記錄的事件數。 要減少接收的事件數，您可以選擇建立聚合值 `numberOfPurchases` 一週或一個月。 MIN和MAX等其他集合函式也可適用於這些情況。

>[!CAUTION]
>
>Experience Platform當前不執行自動值聚合，儘管計畫將來發行。 如果選擇使用聚合值，則必須在將資料發送給 [!DNL Platform]。

#### 基數

在ERD中建立的基數也可以提供一些關於如何對實體進行分類的線索。 如果兩個實體之間存在一對多關係，則表示「多」的實體可能是事件實體。 但是，在有些情況下，「many」是一組查找實體，它們作為陣列在配置檔案實體中提供。

>[!NOTE]
>
>由於沒有適合所有使用情形的通用方法，因此在基於基數對實體進行分類時，必須考慮每種情況的利弊。 查看 [下一部分](#pros-and-cons) 的子菜單。

下表概述了一些常見實體關係以及可從它們派生的類別：

| 關係 | 基數 | 實體類別 |
| --- | --- | --- |
| 客戶和購物車結帳 | 一對多 | 單個客戶可能有許多購物車簽出，這些簽出是可以隨時間跟蹤的事件。 因此，客戶將是配置檔案實體，而購物車簽出將是事件實體。 |
| 客戶和會員帳戶 | 一對一 | 單個客戶只能有一個會員帳戶，反之亦然。 由於關係是一對一的，因此客戶和會員帳戶都表示配置檔案實體。 |
| 客戶和訂閱 | 一對多 | 單個客戶可能有許多訂閱。 由於公司只關心客戶的當前訂閱，因此客戶是配置檔案實體，而訂閱是查找實體。 |

{style="table-layout:auto"}

### 不同實體類的利弊 {#pros-and-cons}

雖然上一節提供了一些關於決定如何對實體分類的一般准則，但必須瞭解，在選擇一個實體類別而不是另一個實體類別時，往往存在利弊。 以下案例研究旨在說明在這些情況下如何考慮您的選項。

公司跟蹤其客戶的活動訂閱，其中一個客戶可以有許多訂閱。 該公司還希望包括訂閱，以便分段使用案例，例如查找所有訂閱活躍的用戶。

在此情形中，公司有兩個潛在選項來表示客戶在其資料模型中的訂閱：

1. [使用配置檔案屬性](#profile-approach)
1. [使用事件實體](#event-approach)

#### 方法1:使用配置檔案屬性 {#profile-approach}

第一種方法是將預訂陣列作為客戶配置檔案實體中的屬性。 此陣列中的對象將包含的欄位 `category`。 `status`。 `planName`。 `startDate`, `endDate`。

<img src="../images/best-practices/profile-schema.png" width="800"><br>

**優點**

* 對於預期的用例，分割是可行的。
* 該架構將僅保留客戶的最新訂閱記錄。

**缺點**

* 每次對陣列中的任何欄位進行更改時，都必須重述整個陣列。
* 如果不同的資料源或業務部門正在將資料饋送到陣列中，則保持最新更新的陣列在所有通道之間同步將變得非常困難。

#### 方法2:使用事件實體 {#event-approach}

第二種方法是使用事件模式來表示預訂。 這要求輸入與第一種方法相同的訂閱欄位，並添加訂閱ID、客戶ID和發生訂閱事件的時間戳。

<img src="../images/best-practices/event-schema.png" width="800"><br>

**優點**

* 細分規則可以更靈活（例如，查找所有在過去30天內更改其訂閱的客戶）。
* 當客戶的訂閱狀態發生更改時，您不再需要更新客戶配置檔案屬性中的長且可能複雜的陣列。 如果同時從多個源對客戶的訂閱清單進行更改，則此操作將特別有用。

**缺點**

* 對於原始的預期用例（識別客戶最近訂閱的狀態），分割變得更複雜。 該段現在需要附加邏輯來標籤客戶的上次訂閱事件以檢查其狀態。
* 事件具有自動過期和從配置檔案儲存中清除的風險。 請參閱上的指南 [體驗事件過期](../../profile/event-expirations.md) 的子菜單。

## 根據分類的實體建立方案

在將實體分類到配置檔案、查找和事件類別後，可以開始將資料模型轉換為XDM架構。 為了進行演示，前面顯示的示例資料模型已在下圖中按適當類別分類：

<img src="../images/best-practices/erd-sorted.png" width="800"><br>

實體已排序到的類別應確定其架構所基於的XDM類。 重申：

* 配置檔案實體應使用 [!DNL XDM Individual Profile] 類。
* 事件實體應使用 [!DNL XDM ExperienceEvent] 類。
* 查找實體應使用由您的組織定義的自定義XDM類。 然後，配置檔案和事件實體可以通過架構關係引用這些查找實體。

>[!NOTE]
>
>雖然事件實體幾乎總是由單獨的架構來表示，但配置檔案或查找類別中的實體可能會在單個XDM架構中組合在一起，具體取決於其基數。
>
>例如，由於Customers實體與LoyaltyAccounts實體具有一對一關係，因此Customers實體的架構還可能包括 `LoyaltyAccount` 對象，以包含每個客戶的相應忠誠度欄位。 但是，如果關係是一對多關係，則表示「許多」的實體可以由單獨的架構或配置檔案屬性陣列表示，具體取決於其複雜性。

以下各節提供了有關基於ERD構建架構的一般指導。

### 採用迭代建模方法

的 [模式演化規則](./composition.md#evolution) 指示只能在方案實施後對其進行非破壞性更改。 換句話說，一旦將欄位添加到架構中，並且已針對該欄位接收了資料，就無法再刪除該欄位。 因此，在首次建立方案時，必須採用迭代建模方法，首先是簡化的實現，它會隨著時間的推移逐漸增加複雜性。

如果您不確定是否需要將某個特定欄位包含在架構中，則最佳做法是將其排除在外。 如果稍後確定該欄位是必需的，則始終可以在架構的下一迭代中添加該欄位。

### 身分欄位

在Experience Platform中，標為標識的XDM欄位用於拼合有關來自多個資料源的單個客戶的資訊。 雖然方案可以具有多個標籤為標識的欄位，但必須定義單個主標識才能啟用該方案以供使用 [!DNL Real-Time Customer Profile]。 請參閱 [標識欄位](./composition.md#identity) 在架構組合的基礎知識中，瞭解有關這些欄位使用案例的更詳細資訊。

在設計方案時，關係資料庫表中的任何主鍵都可能是主要標識的候選項。 適用身份欄位的其他示例包括客戶電子郵件地址、電話號碼、帳戶ID和 [ECID](../../identity-service/ecid.md)。

### Adobe應用程式架構欄位組

Experience Platform提供幾個現成XDM模式欄位組，用於捕獲與以下Adobe應用程式相關的資料：

* Adobe Analytics
* Adobe Audience Manager
* Adobe Campaign
* Adobe Target

例如， [[!UICONTROL Adobe Analytics體驗事件模板] 欄位組](https://github.com/adobe/xdm/blob/master/extensions/adobe/experience/analytics/experienceevent-all.schema.json) 允許您映射 [!DNL Analytics]特定於XDM架構的欄位。 根據您正在使用的Adobe應用程式，您應在方案中使用這些Adobe提供的欄位組。

<img src="../images/best-practices/analytics-field-group.png" width="700"><br>

Adobe應用程式欄位組通過使用 `identityMap` 欄位，它是系統生成的只讀對象，用於為單個客戶映射標準標識值。

對於Adobe Analytics,ECID是預設主標識。 如果客戶未提供ECID值，則主標識將預設為AAID。

>[!IMPORTANT]
>
>使用Adobe應用程式欄位組時，不應將其他欄位標籤為主標識。 如果需要將其他屬性標籤為標識，則需要將這些欄位指定為輔助標識。

## 後續步驟

本文檔介紹了設計資料模型以進行Experience Platform的一般准則和最佳做法。 總結：

* 使用自上而下的方法，在構建方案之前，將資料表分類為配置檔案、查找和事件類別。
* 在為不同目的設計模式時，往往有多種方法和選項。
* 您的資料模型應支援您的業務使用案例，如細分或客戶行程分析。
* 使您的架構盡可能簡單，並且僅在完全需要時添加新欄位。

準備好後，請參閱上的教程 [在UI中建立架構](../tutorials/create-schema-ui.md) 有關如何建立架構的逐步說明，請為實體分配相應的類，並添加將資料映射到的欄位。
